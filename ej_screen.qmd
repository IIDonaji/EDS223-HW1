---
title: "Map making Practice (EDS223-HW1)"
author: "Ixel"
date: "10/06/2025"
format: 
  pdf:
    papersize: letter
    geometry: margin=1in
    code-fold: false
    toc: true
    number-sections: true
execute:
  warning: false
  message: false
---

## Exploring environmental (in)justice

Air quality plays a crucial role in human health and often reflects patterns of environmental injustice, especially in communities exposed to high levels of airborne toxins. In this activity, we will explore air toxic cancer risk and the distribution of air toxins across Los Angeles County.

**Objective:** Practice using `tmap` package to create two maps that communicant an environmental justice issue in California and Los Angeles County.


#### Load packages and read in geodatabase
```{r}
library(tidyverse)
library(sf)
library(stars)
library(tmap)
library(here)
library(tinytex)
```


```{r}
# read in geodatabase of EJScreen data at the Census Block Group level
ejscreen <- sf::st_read(here::here(
  "data", "ejscreen","EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb")) 

# filter to a state you are interested in
california <- ejscreen %>%
  dplyr::filter(ST_ABBREV == "CA") 

# filter to a county you are interested in
Los_Angeles <- ejscreen %>%
  dplyr::filter(CNTY_NAME %in% c("Los Angeles County"))

# find the average values for all variables within counties
california_counties <- aggregate(
  california, by = list(california$CNTY_NAME), FUN = mean)
```



### Visualize data 

## Map one displays the precentile for Toxic Release to Air EJ Index in LA County.
```{r}
# Map one
tm_shape(Los_Angeles) +
  tm_graticules() +
  tm_polygons("P_D2_RSEI_AIR", 
              fill.legend = tm_legend("Toxic Release to Air\n EJ Index Precentile (%)"), 
              fill.scale = tm_scale(values = c("yellow", "darkgreen"))) +
  
tm_compass(type = "4star", size = 1, position = c(-0, 0.3)) +
  
tm_scalebar(position = c(0.5,0)) +
  
tm_title("Precentile of Toxic Release across LA county", size = 1) +   
  tm_layout(component.autoscale = FALSE, frame.double_line = TRUE)

```

Map two: Looks at the precential for Air toxic cancer risk
```{r}
# Map 2
tmap_mode("plot") +
tm_shape(Los_Angeles) +
  tm_graticules() +
  tm_polygons(fill = "P_D2_CANCER",
             fill.scale = tm_scale(values = c("purple", "darkblue")), 
             fill.legend = tm_legend(title = "Presence of Cancer Risk \n Precentile (%)")) +

tm_compass(type = "4star", size = 1, position = c(-0, 0.3)) +
  
tm_scalebar(position = c(0.5,0)) +
  
tm_title("Where the Air is Most Toxic: Cancer Risk Across LA County", size = 1) +   
  tm_layout(component.autoscale = FALSE, frame.double_line = TRUE)

```

### Data Citations 
United States Environmental Protection Agency. 2015. EJSCREEN. Retrieved: October, 06, 2025, from url(www.epa.gov/ejscreen) 